# myPromise
异步发展流程和手写promise

2019.3.16
### 1.callback
只要作用域不销毁 就是闭包

### 2.node fs 模块
读取文件默认从根路径开始找

当n个串行的异步任务执行完毕后，才会执行其他任务
after
通过计数器来控制适合的时机执行回调

### 3.发布订阅模式
观察者模式包含发布订阅模式 

订阅和发布没有关系，通过中间媒介来管理
必须先订阅(on)才能发布(emit)
订阅(on): push arr
发布(emit): arr.forEach(fn => fn())

订阅就是把对应的回调放到数组里面
发布的时候，就拿出数组里面的函数依次执行

### 4.观察者模式
需要先订阅，才能收到发布的消息
vue的双向绑定用的观察者模式

被观察者 需要一个 挂载 观察者的方法，  
观察者需要 一个接受通知的方法。

### 5.Promise
异步解决方案
pending 等待状态 -> fulfilled(resolved) 成功状态
pending 等待状态 -> rejected 失败状态

fulfilled和rejected不能相互转换

定义两个队列

先成功再报错
最后Promise的状态还是成功，因为Promise的状态一旦决议了就不会再改变

不能自己等待自己
当返回值不为空时，并且是个对象或者函数，那就是Promise

如果要让Promise变为失败态
两种方式
(1)调用reject方法
(2)抛出错误异常

then必须返回一个新的Promise，否则可能出现Promise的状态从失败态和成功态相互转换，则是跟原理相悖的
不管成功或者失败函数，只要返回值是个普通值，那就是成功态


